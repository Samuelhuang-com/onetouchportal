{% extends "base.html" %} {% block title %}ç°½æ ¸æ¸…å–® - {{ super() if super else
'OneTouch' }}{% endblock %} {% block content %}
<style>
  .wrap {
    max-width: 1100px;
    margin: auto;
    padding: 8px;
  }
  .card {
    background: #fff;
    border: 1px solid #e5e7eb;
    border-radius: 14px;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.06);
    padding: 14px;
    margin-bottom: 12px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
  }
  th,
  td {
    border-bottom: 1px solid #eee;
    padding: 8px;
    text-align: left;
  }
  .badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 999px;
    border: 1px solid #ddd;
    font-size: 12px;
  }
  .ok {
    background: #ecfdf5;
  }
  .warn {
    background: #fffbeb;
  }
  .muted {
    color: #6b7280;
  }
</style>
<div class="wrap">
  <div class="card">
    <div
      style="display: flex; justify-content: space-between; align-items: center"
    >
      <h2>ğŸ–Šï¸ æˆ‘éœ€è¦ç°½</h2>
      <a class="badge" href="/approvals/new">â• å»ºç«‹ç°½æ ¸å–®</a>
    </div>
    {% if my_todo and my_todo|length>0 %}
    <table>
      <thead>
        <tr>
          <th>ä¸»æ—¨</th>
          <th>é€ç°½äºº</th>
          <th>ç›®å‰é—œå¡</th>
          <th>é€ç°½æ™‚é–“</th>
        </tr>
      </thead>
      <tbody>
        {% for r in my_todo %}
        <tr
          onclick="location.href='/approvals/{{ r.id }}'"
          style="cursor: pointer"
        >
          <td>{{ r.subject }}</td>
          <td>{{ r.requester }}</td>
          <td>#{{ r.step + 1 }}</td>
          <td class="muted">{{ r.submitted_at }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p class="muted">ç›®å‰æ²’æœ‰å¾…ç°½äº‹é …ã€‚</p>
    {% endif %}
  </div>

  <div class="card">
    <h2>ğŸ“¤ æˆ‘é€ç°½</h2>
    {% if my_sent and my_sent|length>0 %}
    <table>
      <thead>
        <tr>
          <th>ä¸»æ—¨</th>
          <th>ç‹€æ…‹</th>
          <th>ç›®å‰é—œå¡</th>
          <th>é€ç°½æ™‚é–“</th>
        </tr>
      </thead>
      <tbody>
        {% for r in my_sent %}
        <tr
          onclick="location.href='/approvals/{{ r.id }}'"
          style="cursor: pointer"
        >
          <td>{{ r.subject }}</td>
          <td>
            {% if r.status=='approved' %}<span class="badge ok">å®Œæˆ</span> {%
            elif r.status=='rejected' %}<span class="badge warn">é€€å›</span> {%
            else %}<span class="badge">é€²è¡Œä¸­</span>{% endif %}
          </td>
          <td>
            {% if r.current_step>=0 %}#{{ r.current_step + 1 }}{% else %}-{%
            endif %}
          </td>
          <td class="muted">{{ r.submitted_at }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p class="muted">å°šæœªé€å‡ºç°½æ ¸ã€‚</p>
    {% endif %}
  </div>
</div>
{% endblock %}
