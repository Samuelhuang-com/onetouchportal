<!-- templates/_navbar.html -->
<nav class="sidebar" role="navigation" aria-label="主選單">
  <!-- 頂部 + 主內容 -->
  <div class="sidebar-top-content">
    <!-- 品牌區 -->
    <div class="sidebar-brand">
      <img
        src="{{ url_for('static', path='logo.png') }}"
        alt="公司 Logo"
        class="logo brand-logo"
      />
      <strong class="portal-name">OneTouch Portal</strong>
    </div>

    <!-- 可滾動主體 -->
    <div class="sidebar-scrollable-content">
      <ul class="sidebar-links">
        {% for item in nav_items %} {% if not item.admin_only or
        (item.admin_only and role == 'admin') %} {% if item.sub_items %} {#
        有子選單 #} {% set submenu_id = 'submenu-' ~ loop.index0 %}
        <li class="has-submenu">
          <!-- 這裡加上 title="{{ item.name }}" -->
          <a
            href="#"
            class="submenu-toggle"
            role="button"
            aria-expanded="false"
            aria-controls="{{ submenu_id }}"
            title="{{ item.name }}"
          >
            <span class="icon">{{ item.icon | safe }}</span>
            <span class="link-name">{{ item.name }}</span>
            <span class="arrow" aria-hidden="true"></span>
          </a>
          <ul class="submenu" id="{{ submenu_id }}">
            {% for sub_item in item.sub_items %}
            <li>
              <!-- 這裡加上 title="{{ sub_item.name }}" -->
              <a
                href="{{ sub_item.url }}"
                class="{{ 'active' if sub_item.url == current_path else '' }}"
                aria-current="{{ 'page' if sub_item.url == current_path else '' }}"
                title="{{ sub_item.name }}"
              >
                <span class="link-name">{{ sub_item.name }}</span>
              </a>
            </li>
            {% endfor %}
          </ul>
        </li>

        {% else %} {# 沒子選單的普通項目 #}
        <li>
          <!-- 這裡加上 title="{{ item.name }}" -->
          <a
            href="{{ item.url }}"
            class="{{ 'active' if item.url == current_path else '' }}"
            aria-current="{{ 'page' if item.url == current_path else '' }}"
            title="{{ item.name }}"
          >
            <span class="icon">{{ item.icon | safe }}</span>
            <span class="link-name">{{ item.name }}</span>
          </a>
        </li>
        {% endif %} {% endif %} {% endfor %}
      </ul>
    </div>
  </div>

  <!-- 頁尾 -->
  <div class="sidebar-footer">
    <a href="/dashboard" title="回首頁">
      <span class="icon">🏠</span>
      <span class="link-name">回首頁</span>
    </a>
    <a href="/logout" title="登出">
      <span class="icon">🚪</span>
      <span class="link-name">登出</span>
    </a>
    <a href="#" id="sidebar-toggle" title="收合選單">
      <span class="icon toggle-icon">↔️</span>
      <span class="link-name">收合選單</span>
    </a>
  </div>
</nav>
