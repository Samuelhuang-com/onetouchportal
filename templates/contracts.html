{% extends "base.html" %} {% block title %}åˆç´„ç®¡ç† - {{ super() }}{% endblock
%} {% block content %}
<div class="page-header">
  <h2>åˆç´„ç®¡ç†</h2>
  <div class="actions">
    <a href="/contracts/add" class="button blue">â• æ–°å¢åˆç´„</a>
    <a href="/contracts/categories" class="button blue">ğŸ—‚ é¡åˆ¥ç¶­è­·</a>
    <a href="/contracts/room_types" class="button blue">ğŸ· æˆ¿å‹ç¶­è­·</a>
  </div>
</div>

{% if contracts %}
<table class="table striped">
  <thead>
    <tr>
      <th style="width: 40px"></th>
      <th>å…¬å¸(ä¸­/è‹±)</th>
      <th>é¡åˆ¥</th>
      <th>æœŸé–“</th>
      <th>æ¥­å‹™</th>
      <th>æ“ä½œ</th>
    </tr>
  </thead>
  <tbody>
    {% for c in contracts %}
    <tr class="summary-row">
      <td><button class="expand-btn">+</button></td>
      <td>{{ c.company_zh }} / {{ c.company_en }}</td>
      <td>{{ c.category or '-' }}</td>
      <td>{{ c.start_date }} ~ {{ c.end_date }}</td>
      <td>{{ c.sales or '-' }}</td>
      <td>
        <a href="/contracts/edit/{{ c.id }}" class="button small">âœï¸ ç·¨è¼¯</a>
      </td>
    </tr>
    <tr class="detail-row" style="display: none; background: #f9f9f9">
      <td></td>
      <td colspan="5">
        <p><strong>è¯çµ¡äººï¼š</strong>{{ c.contact or '-' }}</p>
        <p><strong>é›»è©±ï¼š</strong>{{ c.phone or '-' }}</p>
        <p><strong>åœ°å€ï¼š</strong>{{ c.address or '-' }}</p>
        <p><strong>Emailï¼š</strong>{{ c.email or '-' }}</p>
        <p><strong>ç¨…ç‡ï¼š</strong>{{ c.tax_rate or '-' }}%</p>
        <p><strong>è¨»è¨˜ï¼š</strong>{{ c.notes or '-' }}</p>
        <h4>æˆ¿å‹æ˜ç´°</h4>
        {% if c.rooms %}
        <table class="table inner">
          <thead>
            <tr>
              <th>æˆ¿å‹</th>
              <th>é¢ç©</th>
              <th>æ¯æ™šåƒ¹æ ¼</th>
            </tr>
          </thead>
          <tbody>
            {% for r in c.rooms %}
            <tr>
              <td>{{ r.type }}</td>
              <td>{{ r.area }}</td>
              <td>{{ r.price }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        {% else %}
        <p>ç„¡æˆ¿å‹è³‡æ–™ã€‚</p>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<script>
  // å±•é–‹/æ”¶åˆåŠŸèƒ½
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".expand-btn").forEach((btn) => {
      btn.addEventListener("click", () => {
        const detailRow = btn.closest("tr").nextElementSibling;
        const isHidden = detailRow.style.display === "none";
        detailRow.style.display = isHidden ? "" : "none";
        btn.textContent = isHidden ? "âˆ’" : "+";
      });
    });
  });
</script>
{% else %}
<p>ç›®å‰æ²’æœ‰ä»»ä½•åˆç´„ã€‚</p>
{% endif %} {% endblock %}
